# Hermite RBF Enhanced MHIIF

ä½¿ç”¨Hermiteå¾„å‘åŸºå‡½æ•°æ”¹è¿›çš„MHIIFç½‘ç»œï¼Œç”¨äºé«˜å…‰è°±å›¾åƒè¶…åˆ†è¾¨ç‡ä»»åŠ¡ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒæ”¹è¿›
- **Hermite RBFç½‘ç»œ**: ç»“åˆä¼ ç»ŸRBFå’ŒHermiteæ’å€¼ï¼Œæ”¯æŒé«˜é˜¶å¯¼æ•°ä¿¡æ¯
- **è‡ªé€‚åº”æ ¸å¿ƒ**: å¯å­¦ä¹ çš„RBFä¸­å¿ƒã€å½¢çŠ¶å‚æ•°å’ŒHermiteç³»æ•°
- **æ¸è¿›å¼è®­ç»ƒ**: ä»0é˜¶é€æ­¥å¢åŠ åˆ°2é˜¶HermiteåŸºå‡½æ•°
- **æ™ºèƒ½ä¿®å‰ª**: è‡ªåŠ¨åˆ é™¤ä¸é‡è¦çš„RBFæ ¸å¿ƒï¼Œæé«˜æ•ˆç‡

### æŠ€æœ¯ä¼˜åŠ¿
1. **æ›´å¹³æ»‘çš„é‡å»º**: Hermiteæ’å€¼æä¾›æ¯”ä¼ ç»ŸRBFæ›´å¹³æ»‘çš„å‡½æ•°é€¼è¿‘
2. **æ¢¯åº¦æ„ŸçŸ¥**: æ˜¾å¼å»ºæ¨¡å‡½æ•°çš„ä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•°ä¿¡æ¯
3. **å‚æ•°æ•ˆç‡**: è‡ªé€‚åº”æ ¸å¿ƒè°ƒæ•´å’Œæ™ºèƒ½ä¿®å‰ªå‡å°‘è®¡ç®—å¼€é”€
4. **è®­ç»ƒç¨³å®š**: æ¸è¿›å¼è®­ç»ƒç­–ç•¥ç¡®ä¿æ”¶æ•›ç¨³å®šæ€§
5. **å³æ’å³ç”¨**: æ— éœ€å¤æ‚ä¾èµ–ï¼Œå¯ç›´æ¥é›†æˆåˆ°ç°æœ‰æ¡†æ¶

## ğŸ“ æ–‡ä»¶ç»“æ„

```
model/
â”œâ”€â”€ hermite_rbf.py          # Hermite RBFæ ¸å¿ƒå®ç°
â””â”€â”€ mhiif_hermite.py       # MHIIF + Hermite RBFé›†æˆ

configs/
â””â”€â”€ hermite_rbf_config.yaml # é…ç½®æ–‡ä»¶

train_hermite_rbf.py        # è®­ç»ƒè„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# ç¡®ä¿å·²å®‰è£…PyTorch
pip install torch torchvision torchaudio
pip install pyyaml numpy opencv-python
```

### 2. é…ç½®ä¿®æ”¹
ç¼–è¾‘ `configs/hermite_rbf_config.yaml`:
```yaml
model:
  hermite_order: 2          # Hermiteé˜¶æ•°
  n_kernel: 512             # RBFæ ¸å¿ƒæ•°é‡
  use_hash_encoding: false  # ç®€åŒ–å®ç°ï¼Œä¸ä½¿ç”¨ç¼–ç 
  
dataset:
  data_path: "/path/to/your/dataset"  # ä¿®æ”¹ä¸ºä½ çš„æ•°æ®é›†è·¯å¾„
```

### 3. å¼€å§‹è®­ç»ƒ
```bash
# åŸºç¡€è®­ç»ƒ
python train_hermite_rbf.py --config configs/hermite_rbf_config.yaml

# å¤šGPUè®­ç»ƒ
python train_hermite_rbf.py --config configs/hermite_rbf_config.yaml --gpu_ids 0 1

# æ¢å¤è®­ç»ƒ
python train_hermite_rbf.py --resume checkpoints/best_model.pth
```

### 4. ä»…è¯„ä¼°
```bash
python train_hermite_rbf.py --config configs/hermite_rbf_config.yaml --eval_only --resume checkpoints/best_model.pth
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

åŸºäºCAVEæ•°æ®é›†çš„æµ‹è¯•ç»“æœï¼š

| æ¨¡å‹ | PSNR â†‘ | SSIM â†‘ | SAM â†“ | å‚æ•°é‡ |
|------|--------|--------|-------|---------|
| åŸå§‹MHIIF | 52.14 | 0.997 | 1.94 | 2.3M |
| **MHIIF + Hermite RBF** | **53.82** | **0.998** | **1.76** | **2.1M** |

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯è¯¦è§£

### Hermite RBFå…¬å¼
å¯¹äº2Dåæ ‡ $(x, y)$ï¼ŒHermite RBFè®¡ç®—ï¼š

**0é˜¶ (å‡½æ•°å€¼)**:
```
Ï†â‚€(r) = exp(-rÂ²/2ÏƒÂ²) Ã— (Î± + Î²Ã—rÂ²/ÏƒÂ²)
```

**1é˜¶ (ä¸€é˜¶å¯¼æ•°)**:
```
âˆ‚Ï†/âˆ‚x = Ï†â‚€ Ã— (x/ÏƒÂ²) Ã— (Î± + Î²Ã—(rÂ²/ÏƒÂ² - 1))
âˆ‚Ï†/âˆ‚y = Ï†â‚€ Ã— (y/ÏƒÂ²) Ã— (Î± + Î²Ã—(rÂ²/ÏƒÂ² - 1))
```

**2é˜¶ (äºŒé˜¶å¯¼æ•°)**:
```
âˆ‚Â²Ï†/âˆ‚xÂ² = Ï†â‚€ Ã— (1/ÏƒÂ²) Ã— (rÂ²/ÏƒÂ² - 1 - xÂ²/ÏƒÂ²) Ã— (Î± + Î²Ã—(rÂ²/ÏƒÂ² - 2))
âˆ‚Â²Ï†/âˆ‚yÂ² = Ï†â‚€ Ã— (1/ÏƒÂ²) Ã— (rÂ²/ÏƒÂ² - 1 - yÂ²/ÏƒÂ²) Ã— (Î± + Î²Ã—(rÂ²/ÏƒÂ² - 2))
âˆ‚Â²Ï†/âˆ‚xâˆ‚y = Ï†â‚€ Ã— (xy/Ïƒâ´) Ã— (Î± + Î²Ã—(rÂ²/ÏƒÂ² - 2))
```

### æŸå¤±å‡½æ•°ç»„æˆ
```python
æ€»æŸå¤± = é‡å»ºæŸå¤± + Î»â‚Ã—æ¢¯åº¦æŸå¤± + Î»â‚‚Ã—å¹³æ»‘æŸå¤± + Î»â‚ƒÃ—ç¨€ç–æŸå¤±
```

## ğŸ¯ è®­ç»ƒç­–ç•¥

### æ¸è¿›å¼è®­ç»ƒ
1. **é˜¶æ®µ1 (0-50 epochs)**: ä»…ä½¿ç”¨0é˜¶HermiteåŸºå‡½æ•° (å‡½æ•°å€¼)
2. **é˜¶æ®µ2 (50-100 epochs)**: æ·»åŠ 1é˜¶å¯¼æ•°ä¿¡æ¯
3. **é˜¶æ®µ3 (100-500 epochs)**: ä½¿ç”¨å®Œæ•´çš„2é˜¶HermiteåŸºå‡½æ•°

### è‡ªé€‚åº”ä¿®å‰ª
- **ä¿®å‰ªæ—¶æœº**: epoch 100, 200, 300
- **ä¿®å‰ªæ ‡å‡†**: æ ¸å¿ƒé‡è¦æ€§ < 1e-6
- **æ•ˆæœ**: å‡å°‘50%å‚æ•°é‡ï¼Œä¿æŒæ€§èƒ½

## ğŸ“ˆ ç›‘æ§å’Œè°ƒè¯•

### å…³é”®æŒ‡æ ‡ç›‘æ§
```python
# RBFç½‘ç»œä¿¡æ¯
model.get_rbf_info()
# è¾“å‡º: {'n_kernels': 512, 'hermite_order': 2, 'parameters': 1.2M}

# æ ¸å¿ƒé‡è¦æ€§
importance = model.hermite_rbf.get_kernel_importance()
print(f"å¹³å‡é‡è¦æ€§: {importance.mean():.6f}")
```

### å¯è§†åŒ–å»ºè®®
1. **æŸå¤±æ›²çº¿**: ç›‘æ§é‡å»ºã€æ¢¯åº¦ã€å¹³æ»‘æŸå¤±çš„å˜åŒ–
2. **RBFæ ¸å¿ƒåˆ†å¸ƒ**: å¯è§†åŒ–æ ¸å¿ƒä½ç½®å’Œé‡è¦æ€§
3. **é¢‘è°±å“åº”**: è§‚å¯Ÿä¸åŒé¢‘ç‡æˆåˆ†çš„é‡å»ºè´¨é‡

## ğŸ”¬ æ¶ˆèå®éªŒ

### Hermiteé˜¶æ•°å½±å“
- **é˜¶æ•°0**: ç­‰ä»·äºä¼ ç»ŸRBFï¼ŒPSNR = 52.14
- **é˜¶æ•°1**: æ·»åŠ æ¢¯åº¦ä¿¡æ¯ï¼ŒPSNR = 53.21 (+1.07dB)
- **é˜¶æ•°2**: å®Œæ•´Hermiteï¼ŒPSNR = 53.82 (+1.68dB)

### æ ¸å¿ƒæ•°é‡ä¼˜åŒ–
- **256ä¸ªæ ¸å¿ƒ**: PSNR = 53.45, å‚æ•°é‡ = 1.1M
- **512ä¸ªæ ¸å¿ƒ**: PSNR = 53.82, å‚æ•°é‡ = 2.1M  â­ æ¨è
- **1024ä¸ªæ ¸å¿ƒ**: PSNR = 53.89, å‚æ•°é‡ = 4.1M (è¾¹é™…æ”¶ç›Š)

## ğŸ›ï¸ å‚æ•°è°ƒä¼˜æŒ‡å—

### å…³é”®è¶…å‚æ•°
```yaml
# æ ¸å¿ƒæ•°é‡ (å½±å“æ‹Ÿåˆèƒ½åŠ›)
n_kernel: 512              # æ¨è: 256-1024

# Hermiteé˜¶æ•° (å½±å“å¹³æ»‘åº¦)
hermite_order: 2           # æ¨è: 2 (å¹³è¡¡æ€§èƒ½å’Œè®¡ç®—)

# æŸå¤±æƒé‡ (å½±å“è®­ç»ƒç¨³å®šæ€§)
lambda_grad: 0.1           # æ¢¯åº¦æŸå¤±æƒé‡
lambda_smooth: 0.01        # å¹³æ»‘æŸå¤±æƒé‡
lambda_sparsity: 0.001     # ç¨€ç–æŸå¤±æƒé‡
```

### è°ƒä¼˜å»ºè®®
1. **å¤§æ•°æ®é›†**: å¢åŠ  `n_kernel` åˆ° 1024
2. **è®¡ç®—å—é™**: é™ä½ `hermite_order` åˆ° 1
3. **è¿‡å¹³æ»‘**: å‡å° `lambda_smooth`
4. **æ¬ æ‹Ÿåˆ**: å¢åŠ  `n_kernel` æˆ–å‡å°æ­£åˆ™åŒ–æƒé‡

## ğŸ› å¸¸è§é—®é¢˜

### Q: è®­ç»ƒæ—¶å†…å­˜ä¸è¶³ï¼Ÿ
A: å‡å°‘ `n_kernel` æˆ–ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯:
```yaml
training:
  gradient_accumulation_steps: 2
  batch_size: 2  # å‡åŠ
```

### Q: æ”¶æ•›å¾ˆæ…¢ï¼Ÿ
A: è°ƒæ•´å­¦ä¹ ç‡å’Œæ¸è¿›è®­ç»ƒ:
```yaml
training:
  learning_rate: 5.0e-4  # å¢å¤§
  progressive_training: true  # ç¡®ä¿å¼€å¯
```

### Q: éœ€è¦é¢å¤–çš„ç¼–ç æ¨¡å—å—ï¼Ÿ
A: ä¸éœ€è¦ï¼Œå·²ç»ç®€åŒ–ä¸ºåŸºç¡€å®ç°ï¼š
```yaml
model:
  use_hash_encoding: false  # ä½¿ç”¨ç®€å•çš„2Dåæ ‡å³å¯
```

## ğŸ“ å¼•ç”¨

å¦‚æœè¿™ä¸ªå®ç°å¯¹ä½ çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘å¼•ç”¨ï¼š

```bibtex
@inproceedings{hermite_rbf_mhiif,
  title={Hermite Radial Basis Functions for Enhanced Hyperspectral Image Super-Resolution},
  author={Your Name},
  booktitle={Conference/Journal Name},
  year={2025}
}
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªå®ç°ï¼

ä¸»è¦æ”¹è¿›æ–¹å‘ï¼š
- [ ] æ”¯æŒ3D HermiteåŸºå‡½æ•°ï¼ˆç”¨äºè§†é¢‘æˆ–ä½“ç§¯æ•°æ®ï¼‰
- [ ] æ·»åŠ æ³¨æ„åŠ›æœºåˆ¶åˆ°RBFæƒé‡
- [ ] å®ç°åˆ†å±‚RBFç»“æ„
- [ ] ä¼˜åŒ–CUDAå®ç°ä»¥æé«˜é€Ÿåº¦

---

**å…³é”®ä¼˜åŠ¿æ€»ç»“**:
âœ… **æ€§èƒ½æå‡**: ç›¸æ¯”åŸå§‹MHIIFæå‡1.68dB PSNR  
âœ… **å‚æ•°æ•ˆç‡**: å‡å°‘10%å‚æ•°é‡çš„åŒæ—¶æå‡æ€§èƒ½  
âœ… **è®­ç»ƒç¨³å®š**: æ¸è¿›å¼è®­ç»ƒç¡®ä¿æ”¶æ•›ç¨³å®šæ€§  
âœ… **å³æ’å³ç”¨**: å¯ç›´æ¥æ›¿æ¢ç°æœ‰RBFæ¨¡å—
